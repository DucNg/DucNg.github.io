<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Creating a MPRIS service (server) in Go | Duc Nguyen</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Why? The use case of creating a MPRIS service is basically when you&rsquo;re making a music player and want to broadcast metadata to the system. Since I was creating a webradio player in Go, I needed this feature.
There are a lot of documentation online (and even lib) on how to create a MPRIS client to retrieve currently playing metadata but a lot less when it comes to creating an actual service."><meta name=generator content="Hugo 0.111.3"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link href=/dist/css/app.4fc0b62e4b82c997bb0041217cd6b979.css rel=stylesheet><meta property="og:title" content="Creating a MPRIS service (server) in Go"><meta property="og:description" content="Why? The use case of creating a MPRIS service is basically when you&rsquo;re making a music player and want to broadcast metadata to the system. Since I was creating a webradio player in Go, I needed this feature.
There are a lot of documentation online (and even lib) on how to create a MPRIS client to retrieve currently playing metadata but a lot less when it comes to creating an actual service."><meta property="og:type" content="article"><meta property="og:url" content="https://ducng.github.io/posts/mpris/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-22T17:48:47+01:00"><meta property="article:modified_time" content="2023-03-22T17:48:47+01:00"><meta itemprop=name content="Creating a MPRIS service (server) in Go"><meta itemprop=description content="Why? The use case of creating a MPRIS service is basically when you&rsquo;re making a music player and want to broadcast metadata to the system. Since I was creating a webradio player in Go, I needed this feature.
There are a lot of documentation online (and even lib) on how to create a MPRIS client to retrieve currently playing metadata but a lot less when it comes to creating an actual service."><meta itemprop=datePublished content="2023-03-22T17:48:47+01:00"><meta itemprop=dateModified content="2023-03-22T17:48:47+01:00"><meta itemprop=wordCount content="1537"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Creating a MPRIS service (server) in Go"><meta name=twitter:description content="Why? The use case of creating a MPRIS service is basically when you&rsquo;re making a music player and want to broadcast metadata to the system. Since I was creating a webradio player in Go, I needed this feature.
There are a lot of documentation online (and even lib) on how to create a MPRIS client to retrieve currently playing metadata but a lot less when it comes to creating an actual service."></head><body class="ma0 avenir bg-near-white"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Duc Nguyen</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/contact/ title="Contact page">Contact</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/posts/ title="Posts page">Posts</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/cv/ title="Resume page">Resume</a></li></ul><a href=https://www.linkedin.com/in/nguyen-d/ target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://github.com/DucNg/ target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://ducng.github.io/index.xml target=_blank class="link-transition rss link dib z-999 pt3 pt0-l mr1" title="RSS link" rel=noopener aria-label="RSS——Opens in a new window"><svg xmlns="http://www.w3.org/2000/svg" height="32" width="32" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path id="scale" d="M4 4.44v2.83c7.03.0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9.0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw9 center ph5"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class=mt3><a href="https://www.facebook.com/sharer.php?u=https://ducng.github.io/posts/mpris/" class="facebook no-underline" aria-label="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a href="https://twitter.com/share?url=https://ducng.github.io/posts/mpris/&amp;text=Creating%20a%20MPRIS%20service%20%28server%29%20in%20Go" class="twitter no-underline" aria-label="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://ducng.github.io/posts/mpris/&amp;title=Creating%20a%20MPRIS%20service%20%28server%29%20in%20Go" class="linkedin no-underline" aria-label="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 athelas mt3 mb1">Creating a MPRIS service (server) in Go</h1><time class="f6 mv4 dib tracked" datetime=2023-03-22T17:48:47+01:00>March 22, 2023</time></header><div class="nested-copy-line-height lh-copy Avenir bg-near-white tj f4 nested-links mid-gray pr4-l w-two-thirds-l"><h1 id=why>Why?</h1><p>The use case of creating a MPRIS service is basically when you&rsquo;re making a music player and want to broadcast metadata to the system. Since I was creating a webradio player in Go, I needed this feature.</p><p>There are a lot of documentation online (<a href=https://github.com/leberKleber/go-mpris>and even lib</a>) on how to create a MPRIS client to retrieve currently playing metadata but a lot less when it comes to creating an actual service. Since creating a MPRIS service is an absolute pain and is poorly documented I thought I might tell my journey of archiving it using the great godbus library.</p><h1 id=what-is-mpris>What is MPRIS</h1><p>MPRIS is a D-Bus interface. That&rsquo;s when we need to explain what&rsquo;s a D-Bus interface. D-Bus is a protocol to communicate data between applications on Linux. It&rsquo;s main usage is on the Linux desktop ecosystem. If you need a comparison; if you wanted your web application to communicate with other services you would use an API and communicate with it using HTTP. On Linux, if you need your desktop applications to communicate with each others, you might use D-Bus. udev is a good example of thing that works using D-Bus; it allows management of devices (block devices) in userspace. It&rsquo;s useful to mount devices without root access or detecting devices hotplugs.</p><p>The exact terminology is that we&rsquo;re actually making a D-Bus client that exposes a D-Bus service and in this case, the service is MPRIS. There is only one D-Bus server.</p><p>A common use case is also mine, sharing metadata of currently playing song. The music player (Firefox, mpd, mpv, whatever) works as a D-Bus server that exports currently playing song metadata and the desktop environment act as a client that picks up this information to display it in the taskbar for example.</p><p>To communicate data using D-Bus you write and read data to something called a &ldquo;message bus&rdquo;, we&rsquo;ll talk about this later on.</p><h1 id=implementation>Implementation</h1><p>First of all, I owe great thanks to <a href=https://github.com/natsukagami/mpd-mpris>mpd-mpris</a> for the reference implementation, without this project nothing would have been possible.
And of course, <a href=https://github.com/godbus/dbus>godbus</a>, without it, communicating with dbus in Go would be close to impossible. godbus exposes proper interfaces to make it easier to work with D-Bus and well&mldr; if you thought you could just go the hard way and implement D-Bus bindings yourself, the answer is basically: no you can&rsquo;t. I hope that by reading this article you&rsquo;ll get a glance of why implementing even the most basic thing that communicate with D-Bus is an absolute pain.</p><h2 id=creating-the-d-bus-instance>Creating the D-Bus instance</h2><p>The first thing to do is to create a D-Bus instance. By instance I mean something that will connect to a D-Bus&mldr; bus!</p><p>Our instance needs 2 things: some properties that we will make available to the bus and something to store the connection to the bus.</p><p>godbus offers types to do this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>import</span>(
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;github.com/godbus/dbus/v5&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;github.com/godbus/dbus/v5/prop&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Instance</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>props</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>prop</span>.<span style=color:#a6e22e>Properties</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>conn</span>  <span style=color:#f92672>*</span><span style=color:#a6e22e>dbus</span>.<span style=color:#a6e22e>Conn</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Once we have the instance we can connect to the session bus.</p><h2 id=connect-to-the-session-bus>Connect to the session bus</h2><p>They are 2 types of message bus on D-Bus: the session bus, one for each user session and the system bus that is shared across the whole system. For MPRIS we want the session bus.</p><p>Here is how we connect to the session bus and store the connection in our instance:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>conn</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>dbus</span>.<span style=color:#a6e22e>ConnectSessionBus</span>()
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatalln</span>(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>defer</span> <span style=color:#a6e22e>conn</span>.<span style=color:#a6e22e>Close</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ins</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>Instance</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>conn</span>: <span style=color:#a6e22e>conn</span>,
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=export-props-on-the-bus>Export props on the bus</h2><p>Now, for MPRIS to actually detect our media player, there are a few things we need to export on the bus. The list is available on the official specification<strong>s</strong>.</p><p>MPRIS specifications is called a &ldquo;D-Bus interface&rdquo; and contain a list of properties and functions to implement. We have 2 interfaces to implement:</p><ul><li><a href=https://specifications.freedesktop.org/mpris-spec/latest/Media_Player.html>MediaPlayer2</a></li><li><a href=https://specifications.freedesktop.org/mpris-spec/latest/Player_Interface.html>MediaPlayer2.Player</a></li></ul><p>Giving a quick glance you&rsquo;ll see that almost all properties are mandatory.</p><p>A D-Bus property is composed of 4 things: a value, a function that will be call when the value is changed, a property to define if the value is writable or not and a property that tells how to emit <code>org.freedesktop.DBus.Properties.PropertiesChanged</code> when the value is changed.</p><p>Here is how to implement the simple property &ldquo;<a href=https://specifications.freedesktop.org/mpris-spec/latest/Player_Interface.html#Property:CanPlay>CanPlay</a>&rdquo; of the MPRIS interface:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>canPlay</span> = <span style=color:#a6e22e>prop</span>.<span style=color:#a6e22e>Prop</span>{
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Value</span>:    <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Writable</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Emit</span>:     <span style=color:#a6e22e>prop</span>.<span style=color:#a6e22e>EmitTrue</span>,
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Callback</span>: <span style=color:#66d9ef>nil</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Connect to the session bus
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>ins</span>.<span style=color:#a6e22e>props</span>, <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>prop</span>.<span style=color:#a6e22e>Export</span>(
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>conn</span>,
</span></span><span style=display:flex><span>		<span style=color:#e6db74>&#34;/org/mpris/MediaPlayer2&#34;</span>,
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#f92672>*</span><span style=color:#a6e22e>prop</span>.<span style=color:#a6e22e>Prop</span>{
</span></span><span style=display:flex><span>			<span style=color:#e6db74>&#34;org.mpris.MediaPlayer2&#34;</span>: {<span style=color:#e6db74>&#34;CanPlay&#34;</span>: <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>canPlay</span>},
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>	)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>prop.Export</code> is a &ldquo;magic&rdquo; function of the godbus lib that will do the job of actually exporting the props to D-Bus.</p><p>It takes a connection (that we&rsquo;ve setup earlier), the object path you want your export on and the list of properties to export.</p><p>The object path is the designated path for the interface we&rsquo;re implementing. Any application can declare a path that it communicate on. You can see it like an URL+endpoint of a web app. In the case of MPRIS the path they choose is <code>/org/mpris/MediaPlayer2</code>.</p><p>The list of properties is a <code>map[string]map[string]*prop.Prop</code> with the first level of the map being the name of the interface and the second one the name of the property.</p><p>Good, we&rsquo;ve implemented one property, 18 more to go! 😂</p><h2 id=taking-shortcuts>Taking shortcuts</h2><p>When working with D-Bus, you&rsquo;ll quickly start to realize that most of the stuff is overengineer for your use case. That&rsquo;s when as a good lazy developer you&rsquo;ll start taking shortcuts. We need to implement 19 mandatory properties just for MPRIS to detect our player even if you just actually need one property for you use case.</p><p>A good shortcut I stole from <a href=https://github.com/natsukagami/mpd-mpris>mpd-mpris</a> is the newProp function:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>newProp</span>(<span style=color:#a6e22e>value</span> <span style=color:#66d9ef>interface</span>{}, <span style=color:#a6e22e>cb</span> <span style=color:#66d9ef>func</span>(<span style=color:#f92672>*</span><span style=color:#a6e22e>prop</span>.<span style=color:#a6e22e>Change</span>) <span style=color:#f92672>*</span><span style=color:#a6e22e>dbus</span>.<span style=color:#a6e22e>Error</span>) <span style=color:#f92672>*</span><span style=color:#a6e22e>prop</span>.<span style=color:#a6e22e>Prop</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>prop</span>.<span style=color:#a6e22e>Prop</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Value</span>:    <span style=color:#a6e22e>value</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Writable</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Emit</span>:     <span style=color:#a6e22e>prop</span>.<span style=color:#a6e22e>EmitTrue</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Callback</span>: <span style=color:#a6e22e>cb</span>,
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This will allow us to create a property with just the parameters that are actually useful: the value and the callback function.</p><p>Using the newProp function we can now implement the 19 properties:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>player</span> = <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#f92672>*</span><span style=color:#a6e22e>prop</span>.<span style=color:#a6e22e>Prop</span>{
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;PlaybackStatus&#34;</span>: <span style=color:#a6e22e>newProp</span>(<span style=color:#e6db74>&#34;Playing&#34;</span>, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Rate&#34;</span>:           <span style=color:#a6e22e>newProp</span>(<span style=color:#ae81ff>1.0</span>, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Metadata&#34;</span>:       <span style=color:#a6e22e>newProp</span>(<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>interface</span>{}{}, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Volume&#34;</span>:         <span style=color:#a6e22e>newProp</span>(float64(<span style=color:#ae81ff>100</span>), <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Position&#34;</span>:       <span style=color:#a6e22e>newProp</span>(int64(<span style=color:#ae81ff>0</span>), <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;MinimumRate&#34;</span>:    <span style=color:#a6e22e>newProp</span>(<span style=color:#ae81ff>1.0</span>, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;MaximumRate&#34;</span>:    <span style=color:#a6e22e>newProp</span>(<span style=color:#ae81ff>1.0</span>, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;CanGoNext&#34;</span>:      <span style=color:#a6e22e>newProp</span>(<span style=color:#66d9ef>false</span>, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;CanGoPrevious&#34;</span>:  <span style=color:#a6e22e>newProp</span>(<span style=color:#66d9ef>false</span>, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;CanPlay&#34;</span>:        <span style=color:#a6e22e>newProp</span>(<span style=color:#66d9ef>true</span>, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;CanPause&#34;</span>:       <span style=color:#a6e22e>newProp</span>(<span style=color:#66d9ef>true</span>, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;CanSeek&#34;</span>:        <span style=color:#a6e22e>newProp</span>(<span style=color:#66d9ef>false</span>, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;CanControl&#34;</span>:     <span style=color:#a6e22e>newProp</span>(<span style=color:#66d9ef>false</span>, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>mediaPlayer2</span> = <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#f92672>*</span><span style=color:#a6e22e>prop</span>.<span style=color:#a6e22e>Prop</span>{
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;CanQuit&#34;</span>:             <span style=color:#a6e22e>newProp</span>(<span style=color:#66d9ef>false</span>, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;CanRaise&#34;</span>:            <span style=color:#a6e22e>newProp</span>(<span style=color:#66d9ef>false</span>, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;HasTrackList&#34;</span>:        <span style=color:#a6e22e>newProp</span>(<span style=color:#66d9ef>false</span>, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;Identity&#34;</span>:            <span style=color:#a6e22e>newProp</span>(<span style=color:#e6db74>&#34;myPlayer&#34;</span>, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;SupportedUriSchemes&#34;</span>: <span style=color:#a6e22e>newProp</span>([]<span style=color:#66d9ef>string</span>{}, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;SupportedMimeTypes&#34;</span>:  <span style=color:#a6e22e>newProp</span>([]<span style=color:#66d9ef>string</span>{}, <span style=color:#66d9ef>nil</span>),
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Connect to the session bus
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ins</span>.<span style=color:#a6e22e>props</span>, <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>prop</span>.<span style=color:#a6e22e>Export</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>conn</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/org/mpris/MediaPlayer2&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#f92672>*</span><span style=color:#a6e22e>prop</span>.<span style=color:#a6e22e>Prop</span>{
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;org.mpris.MediaPlayer2&#34;</span>:        <span style=color:#a6e22e>mediaPlayer2</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;org.mpris.MediaPlayer2.Player&#34;</span>: <span style=color:#a6e22e>playerProp</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>All there is left to do now, is to request a name for our player (and check that it&rsquo;s available):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Connect to the session bus
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// Export properties
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>reply</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>conn</span>.<span style=color:#a6e22e>RequestName</span>(<span style=color:#e6db74>&#34;org.mpris.MediaPlayer2.fip-player&#34;</span>, <span style=color:#a6e22e>dbus</span>.<span style=color:#a6e22e>NameFlagReplaceExisting</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatalln</span>(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>reply</span> <span style=color:#f92672>!=</span> <span style=color:#a6e22e>dbus</span>.<span style=color:#a6e22e>RequestNameReplyPrimaryOwner</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatalln</span>(<span style=color:#e6db74>&#34;Name already taken&#34;</span>)
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>select</span> {}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>With this, we should be able to detect our player using a MPRIS client.</p><p><a href=https://github.com/altdesktop/playerctl>playerctl</a> is the ideal candidate to test this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ playerctl -l
</span></span><span style=display:flex><span>myPlayer
</span></span></code></pre></div><p>You can test this yourself using <a href=https://gist.github.com/DucNg/4b60437832f2d007324eba200599b212>my example</a>!</p><h2 id=implement-and-export-functions-on-the-bus>Implement and export functions on the bus</h2><p>Now, that we have our D-Bus hello world, we can start actually implementing things.</p><p>We&rsquo;ll go with a basic use case: start and stop playback by clicking the button in your desktop environment / window manager (or using playerctl).</p><p>Let&rsquo;s start by creating a new type with a couple of public functions:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>MediaPlayer2</span> <span style=color:#66d9ef>struct</span>{}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>m</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>MediaPlayer2</span>) <span style=color:#a6e22e>Pause</span>() <span style=color:#f92672>*</span><span style=color:#a6e22e>dbus</span>.<span style=color:#a6e22e>Error</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// do something to pause playback
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>m</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>MediaPlayer2</span>) <span style=color:#a6e22e>Play</span>() <span style=color:#f92672>*</span><span style=color:#a6e22e>dbus</span>.<span style=color:#a6e22e>Error</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// do something to start playback
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>We can now export this type to D-Bus:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Connect to the session bus
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// Export properties
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mp2</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>MediaPlayer2</span>{}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>conn</span>.<span style=color:#a6e22e>Export</span>(<span style=color:#a6e22e>mp2</span>, <span style=color:#e6db74>&#34;/org/mpris/MediaPlayer2&#34;</span>, <span style=color:#e6db74>&#34;org.mpris.MediaPlayer2.Player&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatalln</span>(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>select</span>{}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Again the <code>conn.Export</code> is a &ldquo;magic&rdquo; function of godbus that will export our interface to the message bus. When a call to the path is made, it will look for public functions of the same name in the interface and call it. Functions need to return <code>*dbus.Error</code> in order to be used by godbus.</p><p>You can test this using playerctl:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>playerctl pause
</span></span><span style=display:flex><span>playerctl play
</span></span></code></pre></div><p>Using this, something should happen on respective functions of your program.</p><h2 id=updating-the-metadata>Updating the metadata</h2><p>Something we might want to do now is to change the props we&rsquo;ve set initially. To do this we can use the <code>props.Set()</code> function:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>metadata</span> = <span style=color:#f92672>&amp;</span><span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>interface</span>{}{
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;mpris:trackid&#34;</span>: <span style=color:#e6db74>&#34;/org/mpris/MediaPlayer2/coolSong&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;mpris:length&#34;</span>:  <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;xesam:title&#34;</span>: <span style=color:#e6db74>&#34;my cool song&#34;</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Connect to the session bus
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// Export properties
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dbusErr</span> = <span style=color:#a6e22e>ins</span>.<span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>Set</span>(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;org.mpris.MediaPlayer2.Player&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Metadata&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dbus</span>.<span style=color:#a6e22e>MakeVariant</span>(<span style=color:#a6e22e>metadata</span>),
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>dbusErr</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>dbusErr</span>, <span style=color:#a6e22e>metadata</span>)
</span></span><span style=display:flex><span>	})
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Thanks to godbus we have an easy way to make a variant of our metadata which mandatory for the change to be effective.</p><p>To know which fields you can set on metadata and their type, you can refer to the <a href=https://www.freedesktop.org/wiki/Specifications/mpris-spec/metadata/>MPRIS metadata spec</a></p><h1 id=conclusion>Conclusion</h1><p>With this you should have a quick overview of how to make a MPRIS server and how to interact with it&rsquo;s main features.</p><p>If you want to go more in depth with a proper implementation, you can look at the source code of <a href=https://github.com/natsukagami/mpd-mpris>mpd-mpris</a> or my <a href=https://github.com/DucNg/fip-player>fip-player</a> using a mpv backend.</p><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://ducng.github.io/>&copy; Duc Nguyen 2023</a><div><a href=https://www.linkedin.com/in/nguyen-d/ target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://github.com/DucNg/ target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://ducng.github.io/index.xml target=_blank class="link-transition rss link dib z-999 pt3 pt0-l mr1" title="RSS link" rel=noopener aria-label="RSS——Opens in a new window"><svg xmlns="http://www.w3.org/2000/svg" height="32" width="32" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path id="scale" d="M4 4.44v2.83c7.03.0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9.0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></footer><script src=/dist/js/app.3fc0f988d21662902933.js></script></body></html>